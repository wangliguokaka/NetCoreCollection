jQuery.extend({createUploadIframe:function(n,t){var r="jUploadFrame"+n,i='<iframe id="'+r+'" name="'+r+'" style="position:absolute; top:-9999px; left:-9999px"';return window.ActiveXObject&&(typeof t=="boolean"?i+=' src="javascript:false"':typeof t=="string"&&(i+=' src="'+t+'"')),i+=" />",jQuery(i).appendTo(document.body),jQuery("#"+r).get(0)},createUploadForm:function(n,t,i){var e="jUploadForm"+n,s="jUploadFile"+n,r=jQuery('<form  action="" method="POST" name="'+e+'" id="'+e+'" enctype="multipart/form-data"><\/form>'),f,u,o;if(i)for(f in i)jQuery('<input type="hidden" name="'+f+'" value="'+i[f]+'" />').appendTo(r);return u=jQuery("#"+t),o=jQuery(u).clone(),jQuery(u).attr("id",s),jQuery(u).before(o),jQuery(u).appendTo(r),jQuery(r).css("position","absolute"),jQuery(r).css("top","-1200px"),jQuery(r).css("left","-1200px"),jQuery(r).appendTo("body"),r},ajaxFileUpload:function(n){var f,t,e,i;n=jQuery.extend({},jQuery.ajaxSettings,n);var r=(new Date).getTime(),i=jQuery.createUploadForm(r,n.fileElementId,typeof n.data=="undefined"?!1:n.data),h=jQuery.createUploadIframe(r,n.secureuri),u="jUploadFrame"+r,o="jUploadForm"+r;n.global&&!jQuery.active++&&jQuery.event.trigger("ajaxStart");f=!1;t={};n.global&&jQuery.event.trigger("ajaxSend",[t,n]);e=function(r){var e=document.getElementById(u),o,h;try{e.contentWindow?(t.responseText=e.contentWindow.document.body?e.contentWindow.document.body.innerHTML:null,t.responseXML=e.contentWindow.document.XMLDocument?e.contentWindow.document.XMLDocument:e.contentWindow.document):e.contentDocument&&(t.responseText=e.contentDocument.document.body?e.contentDocument.document.body.innerHTML:null,t.responseXML=e.contentDocument.document.XMLDocument?e.contentDocument.document.XMLDocument:e.contentDocument.document)}catch(s){jQuery.handleError(n,t,null,s)}if(t||r=="timeout"){f=!0;try{o=r!="timeout"?"success":"error";o!="error"?(h=jQuery.uploadHttpData(t,n.dataType),n.success&&n.success(h,o),n.global&&jQuery.event.trigger("ajaxSuccess",[t,n])):jQuery.handleError(n,t,o)}catch(s){o="error";jQuery.handleError(n,t,o,s)}n.global&&jQuery.event.trigger("ajaxComplete",[t,n]);n.global&&!--jQuery.active&&jQuery.event.trigger("ajaxStop");n.complete&&n.complete(t,o);jQuery(e).unbind();setTimeout(function(){try{jQuery(e).remove();jQuery(i).remove()}catch(r){jQuery.handleError(n,t,null,r)}},100);t=null}};n.timeout>0&&setTimeout(function(){f||e("timeout")},n.timeout);try{i=jQuery("#"+o);jQuery(i).attr("action",n.url);jQuery(i).attr("method","POST");jQuery(i).attr("target",u);i.encoding?jQuery(i).attr("encoding","multipart/form-data"):jQuery(i).attr("enctype","multipart/form-data");jQuery(i).submit()}catch(s){jQuery.handleError(n,t,null,s)}return jQuery("#"+u).load(e),{abort:function(){}}},uploadHttpData:function(n,t){var i=!t;return i=t=="xml"||i?n.responseXML:n.responseText,t=="script"&&jQuery.globalEval(i),t=="json"&&eval("data = "+i),t=="html"&&jQuery("<div>").html(i).evalScripts(),i}});